<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="theme-color" content="#252525">

	<title>Piper Speech Synthesizer Voice Samples</title>

	<meta name="description" content="Online speech synthesizer in WebAssembly (WASM).">
	<meta name="author" content="Jozef Chúťka">
	<meta property="og:title" content="Piper Online Voice Samples">
	<meta property="og:description" content="Online speech synthesizer in WebAssembly (WASM).">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="website">
	<meta name="twitter:site" content="@wide_video">
</head>
<body>
<style>
:root {
	--color1: #007cc9;
	--color2: #3c3c3c;
	--color3: #666;
	--color4: #252525;
	--color5: #ccc;
}

:where(:not(audio, img, select)) {
	all: unset;
	display: revert;
	box-sizing: border-box;
}

html {
	font: 13px/1.4em "Segoe WPC", "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif;
	background: var(--color4);
	color: var(--color5);
	margin: 1rem;
}

h1 {
	color: var(--color5);
	font-weight: bold;
	font-size: 1.1rem;
}

section {
	margin: 0 0 1em 0;
}

button {
	color: var(--color1);
	text-decoration: underline;
	display: inline-block;
	width: 7rem;
	cursor: pointer;
}

audio {
	position: fixed;
	right: 0;
	top: 0;
}
</style>

<audio controls crossorigin="anonymous"></audio>
<script>

(async () => {

const body = document.body;
const audio = document.querySelector("audio");
const voices = await (await fetch("voices-v1.0.0.json")).json();

function create(type, content) {
	const result = document.createElement(type);
	if(content !== undefined)
		result.append(content);
	return result;
}

function createSample(path, speaker) {
	const url = `https://rhasspy.github.io/piper-samples/samples/${path}/speaker_${speaker}.mp3`;
	const result = create("button", `speaker ${speaker}`);
	result.onclick = () => {
		audio.src = url;
		audio.play();
	}
	return result;
}

for(const [key, voice] of Object.entries(voices)) {
	const speakers = Object.values(voice.speaker_id_map);
	const pathChunks = Object.keys(voice.files)[0].split("/");
	pathChunks.pop();
	const path = pathChunks.join("/");

	body.append(create("h1", key));
	const samples = create("section");

	if(!speakers.length)
		samples.append(createSample(path, 0));
	else
		for(const speaker of speakers)
			samples.append(createSample(path, speaker));

	body.append(samples);
}


document.querySelectorAll("div[data-src]").forEach(element => {
	element
})

})()

</script>
</body>
</html>